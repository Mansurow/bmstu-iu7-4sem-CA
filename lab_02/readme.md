# Лабораторная работа 2 "Многомерная интерполяция"

Нужны лекции - [Wiki](https://github.com/Mansurow/IU7-w-2020/wiki#4-%D1%81%D0%B5%D0%BC%D0%B5%D1%81%D1%82%D1%80)

## Данные 
- data.txt - данные из методички - кубическая матрица

####UPDATE - поправлены не дочеты и ошибке в алгоритме для более точной точности

## Результат

Данные прочитанные из файлы data.txt

![image](https://user-images.githubusercontent.com/62243773/157331137-36f41969-99ec-422a-ac1e-a6443870a08e.png)

![image](https://user-images.githubusercontent.com/62243773/157331182-cd51832d-4d39-4d84-98cd-32c058d32a4f.png)

Примеры работы:

- Пример 1

![image](https://user-images.githubusercontent.com/62243773/157331445-3d5f755b-1557-4acb-b562-291acab2dc8d.png)

- Пример 2

![image](https://user-images.githubusercontent.com/62243773/157331977-06384586-1315-49d4-ba14-f49e251292dc.png)

![image](https://user-images.githubusercontent.com/62243773/157332019-fd258eef-8da5-4e1f-a752-3d71585f896e.png)

- Пример 3 - Вопрос 

![image](https://user-images.githubusercontent.com/62243773/157332112-01a2b5f1-b9b2-4d6f-a31d-d69cfd4c6b42.png)


## Вопросы

### 1. Пусть степени nx = ny = nz =1, x=y=z=1.5. Приведите по шагам те значения функции, которые получаются в ходе выполнения процедур последовательных интерполяций. 

![image](https://user-images.githubusercontent.com/62243773/157334522-740cc3d7-3dda-4ee4-84a2-5b2b4b2ec41a.png)


Изначально по-идею беру значения по алгоритму описанный ниже:
Осуществляя многомерную интерполяцию, следует помнить, что расположение
узлов не может быть произвольным. Например, при интерполяции полиномом первой
степени P1 ( x, y ) узлы не должны лежать на одной прямой в плоскости. Проверять условия
подобного типа достаточно сложно, поэтому на практике целесообразно строить регулярные
сетки, как правило, прямоугольные и равномерные, когда узлы являются точками
пересечения двух взаимно перпендикулярных систем параллельных прямых. На этой сетке
проводят простую последовательную интерполяцию: сначала по строкам, а затем по
столбцам.
Покажем, как строится алгоритм на примере интерполяции двумерной табличной
функции z = f (x, y). Задаются степени интерполяционных полиномов по двумкоординатам nx ,ny и значения аргументовx, y. 
Вначале проводится интерполяцию, например, по x. При этом выполняется ny + 1 одномерных интерполяций при выбранных
значениях yj, yj = 0,1,...n, и вычисляются значения функции yj, f (x , y ), j = 0,1,...n. А затем по полученным значениям функции, привязанным теперь к yj, совершается одна интерполяция по y . 

То есть простыми словами беру значение по столбцу и работаю с ними:

![image](https://user-images.githubusercontent.com/62243773/157334583-e1a6872d-1edd-4d81-a845-e51ddb88482d.png)

Если посмотреть на вторые координаты то они взяты из кубической матрицы.

Даллее и спользуя полином Ньютона расчитываю, все жти 4 выше указанных стобца и получаю, такие данные:

![image](https://user-images.githubusercontent.com/62243773/157334880-01b17f65-257f-4a0d-80e4-94280457ffb6.png)

Так проделываю, пока не получю все значения для следующиего этапа, а именно проделываю тоже самое, но только беру следующие столюцы для расчетов, и получаю:

![image](https://user-images.githubusercontent.com/62243773/157335165-eb30f0c8-32f6-48da-84c0-a6d40b30f52e.png)
![image](https://user-images.githubusercontent.com/62243773/157335211-c1788346-8a78-43a3-ac57-035b047e1bb1.png)
![image](https://user-images.githubusercontent.com/62243773/157335234-4da13e32-7f15-49b1-8c5e-e8332550f657.png)
![image](https://user-images.githubusercontent.com/62243773/157335251-d6ea5d49-7527-4298-b1fa-ba68ac883322.png)

Слудующим этапом неоюходимо получить данные по результатам этих таблиц, то есть считаю эти таблицы полином ньютона и получаю:

![image](https://user-images.githubusercontent.com/62243773/157335407-b980b94e-4847-4fa9-8241-9122b68611a7.png)

И снова повторяя эту операцию:

![image](https://user-images.githubusercontent.com/62243773/157335458-b486966e-8bca-432a-b933-80e81cbf3cb3.png)


### 2. Какова минимальная степень двумерного полинома, построенного на трех узлах? На шести узлах?

На трех узлах - 2

На шести узлах - 5

### 3. Предложите алгоритм двумерной интерполяции при хаотичном расположении узлов,т.е. когда таблицы функции на регулярной сетке нет, и метод последовательнойинтерполяции не работает. Какие имеются ограничения на расположение узлов приразных степенях полинома?

При работе с нерегулярной сеткой. Ограничиваем интерполяционный
полиномом первой степени, имеем z = a + bx + cy , и его коэффициенты
находят по трем узлам, выбираемым в окрестности точки интерполяции:

`zi = a + bxi + cyi , 0 <= i <= 2 , здесь i - номер узла.`

Точно так же
можно использовать полином второй степени , 

`zi = a + bxi + cyi + dxi +gyi + hxiyi, 0 <= i <= 5.`

Понятно, что выбираются 6 узлов, ближайших к
точке интерполяции.

При интерполяции полиномом первой степени `P( x, y )` узлы не должны
лежать на одной прямой в плоскости, а при второй степени – не должны лежать в одной плоскости.

### 4. Опишите алгоритм построения функции интерполяции по n переменным.

![image](https://user-images.githubusercontent.com/62243773/157412031-4a82c3d7-e6f6-42cc-b4b4-7b31a5782538.png)

### 5. Можно ли при последовательной интерполяции по разным направлениям использовать полиномы несовпадающих степеней или даже разные методы одномерной интерполяции, например, полином Ньютона и сплайн?

Да, можно так как эти два действия независимые

### 6. Опишите алгоритм двумерной интерполяции на треугольной конфигурации узлов.

Пусть конфигурация представлена в таблице.
Проведем интерполяцию по строкам. Степень полинома будет уменьшаться на один по каждой строке. Далее из полученного столбца проведем интерполяцию. 

При треугольной конфигурации расположения узлов степень многочлена
будет минимальной. Многочлен n-й степени в форме Ньютона для двумерной
интерполяции в этом случае можно представить как обобщение одномерного
варианта записи: 

![image](https://user-images.githubusercontent.com/62243773/157413295-ef5ee0af-bcc6-47ab-9e63-814d73af5a0a.png)

